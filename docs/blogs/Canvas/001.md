---
title: canvas 使用
date: 2025-08-13
categories: 
 - canvas
tags:
 - canvas
---

## 认识canvas
是一个可以使用脚本(通常为JavaScript)来绘制图形的 HTML 元素.
## 使用
### 基本用法
### 渲染上下文
### 绘制形状
#### 直线
绘制之前前了解三个函数：
+ moveTo(x, y)
    设置初始位置，参数为初始位置x和y的坐标点
+ lineTo(x, y)
    绘制一条从初始位置到指定位置的直线，参数为指定位置x和y的坐标点
+ stroke()
    通过线条来绘制图形轮廓

例子：
```html
<body>
    <canvas id="canvas" width="500" height="500">
        hel can
    </canvas>
    <script>
        var canvas = document.getElementById('canvas');
        if (canvas.getContext) {
            var ctx = canvas.getContext('2d');
            ctx.moveTo(100, 100);
            ctx.stroke();
        }
    </script>
</body>
```
#### 三角形

```js
var canvas = document.getElementById('canvas');
if (canvas.getContext) {
    var ctx = canvas.getContext('2d');
    ctx.moveTo(100, 100);
    ctx.lineTo(200, 200);
    ctx.lineTo(200, 100);
    ctx.lineTo(100, 100);
    ctx.stroke();
}
```

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/32bbfbff59804a618b1bd6d864b842cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755161273&x-orig-sign=1p4muuXdG3GgzQnK%2B%2FBgyrZVi0I%3D)
#### 矩形
矩形也可以通过直线来绘制，但是太麻烦了，`Canvas API` 给提供了三种绘制矩形的方法：

+ strokeRect(x, y, width, height)
    绘制一个矩形的边框
    ```js
    var canvas = document.getElementById('canvas');
    if (canvas.getContext) {
        var ctx = canvas.getContext('2d');
        ctx.strokeRect(100, 100, 200, 200);
    }
    ```
    ![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/b4d695739a7d450d82b518b7874c21c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755161389&x-orig-sign=tyiEYsBC8KxmM6eBj8ovlPRwk1U%3D)
+ fillRect(x, y, width, height)
    绘制一个填充的矩形
    ```js
    var ctx = canvas.getContext('2d');
    ctx.fillRect(100, 100, 200, 200);
    ```
    ![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/8c47e7f29e5c4fbd9a52de3f56e63313~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755161453&x-orig-sign=y9UzWjqtx%2BNtlhdq8W24f%2FBSAec%3D)
+ clearRect(x, y, width, height)
    清除指定矩形区域，让清除部分完全透明
    ```js
    var ctx = canvas.getContext('2d');
    ctx.fillRect(100, 100, 200, 200);
    ctx.fillRect(50, 50, 200, 200);
    ctx.clearRect(100, 100, 100, 100);
    ```
    ![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/7f9150b4ed89476f9d607dfe42235a12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755161565&x-orig-sign=Iu1wWXnetPzB2ItkUUWRPAr%2B0jk%3D)
#### 圆弧、圆
绘制圆弧或圆使用的方法是 `arc(x, y, radius, startAngle, endAngle, anticlockwise)`
`x, y` 为圆心坐标；
`radius` 为半径；
`startAngle` 为圆弧或圆开始的地方；
`endAngle` 为圆弧或圆结束的地方；
`anticlockwise` 为圆弧或圆的绘制方向（不写默认为 `false`, 顺时针方向）

+ 圆弧
```js
var ctx = canvas.getContext('2d');
ctx.arc(200, 200, 50, 0, Math.PI);
ctx.stroke();
```

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/fc7add5f5bf24f93a59cc78176a365f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755163555&x-orig-sign=Z4%2F0GcQTqKeOSXLM%2BxuLrCM6vFI%3D)

**在画弧的时候，`arc()`函数中角的单位是弧度而不是角度。角度换算为弧度的表达式为：`弧度=(Math.PI/180)*角度`。**

所以想要画圆的话，弧度：`Math.PI*2`

+ 圆

再画一个圆：

```js
// 获取绘图上下文
var ctx = canvas.getContext('2d');

ctx.arc(200, 200, 50, 0, Math.PI, false);
ctx.stroke();

ctx.arc(400, 200, 50, 0, Math.PI * 2, false);
ctx.stroke();
```

但效果似乎不想我们想象的一样，如下图：

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/f8c8ef13b99a452d94e054cc37815233~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755169192&x-orig-sign=e2aYcIPRSYUKkzVAmN877%2BIN9m4%3D)

这是因为每次新建路径的时候都需要开启和闭合路径，这样不同的路径之间才不会相互干扰。如何开启/闭合？

+ beginPath
新建一条路径，生成之后，图形绘制命令被指向到路径上。
+ closePath
闭合路径之后图形绘制命令又重新指向到上下文中。 

具体用法：

```js
// 获取绘图上下文
var ctx = canvas.getContext('2d');
ctx.beginPath(); // 开启路径
ctx.arc(200, 200, 50, 0, Math.PI, false);
ctx.stroke();
ctx.closePath(); // 关闭路径

ctx.beginPath(); // 开启路径
ctx.arc(400, 200, 50, 0, Math.PI * 2, false);
ctx.stroke();
ctx.closePath(); // 关闭路径
```

效果：
![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/692efcc870114e4d9ee9eedc6b182a88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755169659&x-orig-sign=5H12kK6NxsUwj2GvUaAgv8P8jkg%3D)

**另外，关闭路径其实并不是必须的，对于新路径其实每次都开启新路径即可。**

以上都使用的 `stroke` 方法来做描边，另外有 `fill` 方法是通过填充路径的内容区域生成实心的图形。

+ fill

```js
// 获取绘图上下文
var ctx = canvas.getContext('2d');
ctx.beginPath(); // 开启路径
ctx.arc(200, 200, 50, 0, Math.PI, false);
ctx.stroke();
ctx.closePath(); // 关闭路径

ctx.beginPath(); // 开启路径
ctx.arc(400, 200, 50, 0, Math.PI * 2, false);
ctx.stroke();
ctx.closePath(); // 关闭路径

ctx.beginPath(); // 开启路径
ctx.arc(50, 100, 50, 0, Math.PI / 2, false);
ctx.fill();
ctx.closePath(); // 关闭路径

ctx.beginPath(); // 开启路径
ctx.arc(200, 100, 50, 0, Math.PI * 2, false);
ctx.fill();
ctx.closePath(); // 关闭路径
```
![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/b919dd18c6d141ea90f3906a8c6e7dcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755170318&x-orig-sign=js0Fyr8NOXWACCPzKK73VmnAkQQ%3D)
#### 椭圆
语法：`ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)`

>x、y：椭圆的圆心位置
radiusX、radiusY：x轴和y轴的半径
rotation：椭圆的旋转角度，以弧度表示
startAngle：开始绘制点
endAngle：结束绘制点
anticlockwise：绘制的方向（默认顺时针），可选参数。

#### 贝塞尔曲线

贝塞尔曲线一般用来绘制复杂有规律的图形，在Canvas中也是一个十分有用的路径类型。

+ 二次贝塞尔曲线
语法：`quadraticCurveTo(cp1x, cp1y, x, y)`，其中`cp1x`和`cp1y`为一个控制点，`x`和`y`为结束点。

```js
// 获取绘图上下文
var ctx = canvas.getContext('2d');
ctx.moveTo(50, 50);
// 二次贝塞尔曲线
ctx.quadraticCurveTo(200, 200, 400, 40);
ctx.stroke();
```
![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/b2b7bd990a8042f4adac3c05e7d6001b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755170674&x-orig-sign=k%2Fi3WHJBfhCmAZkSUVRzQ2gKnsw%3D)

可借助二次贝塞尔曲线调试工具来找到自己想要的效果：https://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html

+ 三次贝塞尔曲线
语法：`ctx.bezierCurveTo(cp1x,cp1y, cp2x,cp2y, x, y)`，其中`cp1x`和`cp1y`为一个控制点，`cp2x`和`cp2y`为第二个控制点，`x`和`y`为结束点。

```js
// 获取绘图上下文
var ctx = canvas.getContext('2d');
ctx.moveTo(50, 50);
// 二次贝塞尔曲线
ctx.quadraticCurveTo(200, 200, 400, 40);
ctx.stroke();

ctx.beginPath();
ctx.moveTo(50, 350);
// 三次贝塞尔曲线
ctx.bezierCurveTo(100, 200, 200, 450, 500, 350);
ctx.stroke();
```

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/0e0b94f20049485da8af504d839a5364~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755171127&x-orig-sign=j5k8TKsdjuzwRvui%2FdfkGnfBMGY%3D)

相应的，也可以使用三次贝塞尔曲线调试工具：https://blogs.sitepointstatic.com/examples/tech/canvas-curves/bezier-curve.html

### 绘制样式
#### 线条的样式
+ lineWidth: 设置当前绘线的粗细。属性值必须为正数。默认值是 1.0。
+ ineCap 设置线段端点显示的样子。可选值为：butt，round 和 square。默认是 butt。
+ lineJoin 该属性可以设置两线段连接处所显示的样子。可选值为：round, bevel 和 miter。默认是 miter。
+ miterLimit 限制当两条线相交时交接处最大长度；所谓交接处长度（斜接长度）是指线条交接处内角顶点到外角顶点的长度。
+ setLineDash/getLineDash `setLineDash` 可以设置当前虚线样式。`getLineDash` 则是返回当前虚线设置的样式，长度为非负偶数的数组。
+ lineDashOffset 设置虚线样式的起始偏移量。

#### 透明度

除了绘制实色的图形，还可以绘制有透明度的图形。通过设置 globalAlpha 属性或者使用有透明度的样式作为轮廓或填充都可以实现


```js
var ctx = canvas.getContext('2d');
// 绘制一个半透明矩形
ctx.fillStyle = "rgba(0, 255, 0, 0.2)";
ctx.fillRect(50, 50, 100, 100);

// 绘制一个半透明圆
ctx.beginPath();
ctx.arc(200, 100, 50, 0, Math.PI * 2, false);
ctx.fillStyle = "rgba(255, 255, 0, 1)";
ctx.globalAlpha = 0.3;
ctx.fill();
```

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/78a21898fa55465da3a60e2bc607ea80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755172601&x-orig-sign=gDlDuN8OCNwfo%2BrtM2w9u%2FdSYbc%3D)
#### 渐变
渐变分为两种，分别是线性渐变和径向渐变，在绘图中我们可以用线性或者径向的渐变来填充或描边。

+ 线性渐变

语法： `createLinearGradient(x1, y1, x2, y2)`，参数分别为 起点的坐标和终点的坐标。

在渐变的设置中还需要一个方法来添加渐变的颜色，语法为：`gradient.addColorStop(offset, color)`，其中`color`就是颜色，`offset`则是颜色的偏移值，只为0到1之间的数。

```js
// 获取绘图上下文
const ctx = canvas.getContext('2d');
const gradient1 = ctx.createLinearGradient(10, 10, 300, 10);
gradient1.addColorStop(0, 'green');
gradient1.addColorStop(0.5, 'blue');
gradient1.addColorStop(1, 'purple');


ctx.beginPath();
ctx.fillStyle = gradient1;
ctx.fillRect(10, 10, 300, 200);
```
![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/9cd454215c22490197e746229021c40f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755173316&x-orig-sign=d%2FF3YCZAdbGBh8KtUjI4tBycS7s%3D)

+ 径向渐变

语法：`ctx.createRadialGradient(x0, y0, r0, x1, y1, r1)`，参数分别为开始圆的坐标和半径以及结束圆的坐标和半径。

#### 图案样式

语法：`createPattern(image, type)`，参数分别为：`Image` 参数可以是一个 `Image` 对象，也可以是一个 `canvas` 对象，`Type` 为图案绘制的类型，可用的类型分别有：`repeat`，`repeat-x`，`repeat-y` 和 `no-repeat`。

```js
const ctx = canvas.getContext('2d');
const img = new Image();
img.src = 'https://img0.baidu.com/it/u=3092547816,2835351157&fm=253&fmt=auto&app=138&f=JPEG?w=250&h=250';
img.onload = function () {
    const ptn = ctx.createPattern(img, 'no-repeat');
    ctx.fillStyle = ptn;
    ctx.fillRect(0, 0, 500, 500);
}
```

no-repeat

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/c48cdda15a1444f2a88f96586df48ad4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755174569&x-orig-sign=j5Y3Yp7xWGgnTSeur3M0dVsQwPs%3D)

repeat

![image.png](https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/f1d37c68d24e4f5fa84a25fe15a59e4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVmVuY2lraQ==:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzcyOTE2NTc4MTYwMTc1OCJ9&rk3s=e9ecf3d6&x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&x-orig-expires=1755174583&x-orig-sign=ISgMcj0bxIEhls0TKHM152Pr%2BOk%3D)

### 绘制文本

### 绘制图片

#### drawImage
这里咱们主要要说的就是`drawImage`方法的使用，他的用法有三种，是根据不同的传参实现不同的功能。先看看都有哪些参数：

> image：绘制到上下文的元素。
sx、sy：裁剪框的左上角X轴坐标和Y轴坐标。
sWidth、sHeight：裁剪框的宽度和高度。
dx、dy：绘制到上下文的元素，在上下文中左上角的X轴坐标和Y轴坐标。
dWidth、dHeight：绘制到上下文的元素，在上下文中绘制的宽度和高度。如果不说明，在绘制时image宽度和高度不会缩放。

`drawImage(image, dx, dy)`：只有单纯的绘制功能，可以绘制图片、视频和别的`Canvas`对象等。

```js
const ctx = canvas.getContext('2d');
const img = new Image();
img.src = 'https://img1.baidu.com/it/u=2653866704,3262262178&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=500';
img.onload = function () {
    const ptn = ctx.drawImage(img, 0, 0);
}
```

### 绘制动画
。。。
